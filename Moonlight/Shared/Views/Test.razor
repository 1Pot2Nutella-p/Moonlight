@page "/test"

@using Moonlight.Shared.Components.FileManagerPartials
@using Moonlight.App.Repositories.Servers
@using Moonlight.App.Helpers.Files
@using Microsoft.EntityFrameworkCore
@using Moonlight.App.Helpers

@inject ServerRepository ServerRepository
@inject WingsApiHelper WingsApiHelper
@inject WingsJwtHelper WingsJwtHelper

<LazyLoader Load="Load">
    <FileManager Access="FileAccess">
    </FileManager>
</LazyLoader>

@code
{
    private IFileAccess FileAccess;

    private Task Load(LazyLoader arg)
    {
        var server = ServerRepository
            .Get()
            .Include(x => x.Node)
            .First();

        FileAccess = new WingsFileAccess(WingsApiHelper, WingsJwtHelper, server);

        return Task.CompletedTask;
    }
}